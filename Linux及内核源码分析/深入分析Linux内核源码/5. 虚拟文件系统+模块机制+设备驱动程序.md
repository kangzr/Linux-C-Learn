#### 虚拟文件系统

VFS提供一个统一的接口（实际就是file_operation数据结构），主要作用如下：

- 对具体文件系统的数据结构进行抽象，以一种统一的数据结构进行管理
- 接收用户层的系统调用，例如write，open等
- 支持多种具体文件系统之间互相访问
- 接收内核其它子系统的操作请求，特别是内存管理子系统
- ![linux_vfs](..\..\pic\linux_vfs.png)

- 超级块：对应于存放在磁盘上的文件系统控制块，每个文件系统都有一个超级快对象

  ```c
  struct super_block {
      
  };
  ```

  

- 索引节点（inode）对象：存放具体文件的一般信息。对应磁盘上的文件控制块FCB，每个文件都有一个索引节点对象。

  ```c
  struct inode {
      
  };
  ```

  

- 目录项dentry对象：存放目录项对应文件进行链接的信息。

- 文件file对象：存放打开文件与进程之间进行交互的有关信息，仅当进程访问文件期间存在于内存中。



#### 模块机制

模块是内核的一部分（通常是设备驱动程序），但并没有被编译到内核里面。它们被分别编译并连接成一组目标文件，这些文件能被插入到正在运行的内核（insmod插入模块），或者从正在运行的内核中移走（rmmod移除模块）；

内核模块的动态装载性：

- 将内核映像的尺寸保持在最小，并具有最大的灵活性
- 便于检验新的内核代码，而不需要重新编译内核并重新引导

```c
EXPORT_SYMBOL(sleep_on);
// 移出符号，使得内核符号放在一个公开的地方，使得装入到内核中的其它模块可以引用它们。
```

























